<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Crypto‑Prices Banner v18</title>
<style>
 :root{
  --banner-h:50px;              /* altura em px                                   */
  --scroll-duration:120s;       /* quanto MAIOR, mais devagar o scroll            */
  --bg:#0e1117;                 /* cor de fundo                                   */
  --text:#e6e8ea;               /* cor do texto                                   */
  --divider:#2c313d;            /* cor dos divisores verticais                    */
 }
 html,body{margin:0;padding:0;background:transparent;font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",Helvetica,Arial,sans-serif;}
 #cryptoBanner{position:absolute;inset:0 auto auto 0;height:var(--banner-h);background:var(--bg);color:var(--text);overflow:hidden;white-space:nowrap;box-shadow:0 3px 8px rgba(0,0,0,.45);}
 .track{display:flex;height:100%;align-items:center;animation:scroll var(--scroll-duration) linear infinite;will-change:transform;}
 @keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)} }
 #cryptoBanner:hover .track{animation-play-state:paused;}
 .item{display:flex;align-items:center;gap:6px;padding:0 12px;border-right:1px solid var(--divider);font-size:13px;font-weight:600;}
 .item img{height:18px;width:18px;object-fit:contain;border-radius:50%;background:#fff;}
 .price{font-variant-numeric:tabular-nums;}
 .up{color:#00d97e;}
 .down{color:#ff5c5c;}
</style>
</head>
<body>
<div id="cryptoBanner"><div id="track" class="track"></div></div>
<script>
/* =============================================================
   Crypto‑price banner v18  (100% logos via CoinGecko)
   - usa /simple/price para cotações
   - na mesma chamada paralela, puxa /coins/[id] (sem market_data)
     para garantir que SEMPRE tenha image.small
   =============================================================*/

const API_KEY     = "CG-demo-key";   // troque para sua chave: https://www.coingecko.com/pt/api
const CHUNK       = 20;              // ids por requisição (cotações)
const REFRESH_MS  = 60_000;          // auto‑refresh a cada minuto

// Lista desejada — mantenha ordem
const COINS=[
  {id:"bitcoin",symbol:"BTC"},{id:"ethereum",symbol:"ETH"},{id:"solana",symbol:"SOL"},{id:"tron",symbol:"TRX"},{id:"dogecoin",symbol:"DOGE"},
  {id:"hyperliquid",symbol:"HYPE"},{id:"sui",symbol:"SUI"},{id:"chainlink",symbol:"LINK"},{id:"avalanche-2",symbol:"AVAX"},{id:"toncoin",symbol:"TON"},
  {id:"shiba-inu",symbol:"SHIB"},{id:"monero",symbol:"XMR"},{id:"polkadot",symbol:"DOT"},{id:"uniswap",symbol:"UNI"},{id:"pepe",symbol:"PEPE"},
  {id:"aave",symbol:"AAVE"},{id:"near",symbol:"NEAR"},{id:"ondo-finance",symbol:"ONDO"},{id:"render-token",symbol:"RNDR"},{id:"cosmos",symbol:"ATOM"},
  {id:"arbitrum",symbol:"ARB"},{id:"jupiter",symbol:"JUP"},{id:"celestia",symbol:"TIA"},{id:"fartcoin",symbol:"FART"},{id:"sei-network",symbol:"SEI"},
  {id:"stacks",symbol:"STX"},{id:"dogwifhat",symbol:"WIF"},{id:"jito-governance-token",symbol:"JTO"},{id:"lido-dao",symbol:"LDO"},{id:"pendle",symbol:"PENDLE"},
  {id:"eigenlayer",symbol:"EIGEN"},{id:"etherfi",symbol:"ETHERFI"},{id:"popcat",symbol:"POPCAT"},{id:"layerzero",symbol:"ZRO"},{id:"virtuals-protocol",symbol:"VIRTUAL"}
];

const fmt=n=>typeof n==="number"?n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"–";

async function priceChunk(ids){
  const url=`https://api.coingecko.com/api/v3/simple/price?vs_currencies=usd&ids=${ids}&include_24hr_change=true&x_cg_pro_api_key=${API_KEY}`;
  const r = await fetch(url);
  if(!r.ok) throw new Error(r.status);
  return r.json();
}

async function iconOf(id){
  try{
    const r = await fetch(`https://api.coingecko.com/api/v3/coins/${id}?localization=false&tickers=false&market_data=false&community_data=false&developer_data=false&sparkline=false&x_cg_pro_api_key=${API_KEY}`);
    if(!r.ok) throw new Error();
    const j = await r.json();
    return j.image?.small || "";
  }catch{ return ""; }
}

function letter(sym){
  return `<span style="display:inline-block;width:18px;height:18px;line-height:18px;font-size:11px;font-weight:700;background:#40454f;border-radius:50%;text-align:center;color:#fff;">${sym[0]}</span>`;
}

async function load(){
  try{
    const priceData={};
    const iconMap ={};
    for(let i=0;i<COINS.length;i+=CHUNK){
      if(i) await new Promise(r=>setTimeout(r,1200));
      const slice=COINS.slice(i,i+CHUNK);
      const [prices] = await Promise.all([
        priceChunk(slice.map(c=>c.id).join(",")),
        ...slice.map(async c=>{iconMap[c.id]=await iconOf(c.id);})
      ]);
      Object.assign(priceData,prices);
    }

    const html = COINS.map(c=>{
      const p=priceData[c.id];
      if(!p) return "";
      const ch=p.usd_24h_change; const cls=ch>=0?"up":"down"; const sign=ch>=0?"+":"";
      const img=iconMap[c.id]?`<img src="${iconMap[c.id]}" onerror="this.outerHTML='${letter(c.symbol)}'">`:letter(c.symbol);
      return `<div class="item">${img} <b>${c.symbol}</b> $${fmt(p.usd)} <span class="${cls}">${sign}${fmt(ch)}%</span></div>`;
    }).filter(Boolean).join("");

    if(!html) throw new Error("sem dados");
    const track=document.getElementById("track");
    track.innerHTML=html+html;
  }catch(e){
    console.error(e);
    document.getElementById("cryptoBanner").textContent="⚠️ erro ao carregar preços";
  }
}

load();
setInterval(load,REFRESH_MS);
</script>
</body>
</html>
